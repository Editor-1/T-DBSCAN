{"remainingRequest":"E:\\GitProject\\T-DBSCAN\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\GitProject\\T-DBSCAN\\src\\components\\ImageUpload\\index.vue?vue&type=style&index=0&id=82a94682&scoped=true&lang=scss","dependencies":[{"path":"E:\\GitProject\\T-DBSCAN\\src\\components\\ImageUpload\\index.vue","mtime":1719903068000},{"path":"E:\\GitProject\\T-DBSCAN\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\GitProject\\T-DBSCAN\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1720856215764},{"path":"E:\\GitProject\\T-DBSCAN\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"E:\\GitProject\\T-DBSCAN\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\GitProject\\T-DBSCAN\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\GitProject\\T-DBSCAN\\node_modules\\vue-loader\\lib\\index.js","mtime":1720856215506}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgovLyAuZWwtdXBsb2FkLS1waWN0dXJlLWNhcmQg5o6n5Yi25Yqg5Y+36YOo5YiGCjo6di1kZWVwLmhpZGUgLmVsLXVwbG9hZC0tcGljdHVyZS1jYXJkIHsKICBkaXNwbGF5OiBub25lOwp9Ci8vIOWOu+aOieWKqOeUu+aViOaenAo6OnYtZGVlcCAuZWwtbGlzdC1lbnRlci1hY3RpdmUsCjo6di1kZWVwIC5lbC1saXN0LWxlYXZlLWFjdGl2ZSB7CiAgdHJhbnNpdGlvbjogYWxsIDBzOwp9Cgo6OnYtZGVlcCAuZWwtbGlzdC1lbnRlciwgLmVsLWxpc3QtbGVhdmUtYWN0aXZlIHsKICBvcGFjaXR5OiAwOwogIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgwKTsKfQo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/components/ImageUpload","sourcesContent":["<template>\n  <div class=\"component-upload-image\">\n    <el-upload\n      multiple\n      :action=\"uploadImgUrl\"\n      list-type=\"picture-card\"\n      name=\"image\"\n      :on-success=\"handleUploadSuccess\"\n      :before-upload=\"handleBeforeUpload\"\n      ref=\"imageUpload\"\n      :show-file-list=\"true\"\n      :file-list=\"fileList\"\n    >\n      <i class=\"el-icon-plus\"></i>\n    </el-upload>\n  </div>\n</template>\n\n<script>\nfunction validateImage(file) {\n  const isJpgOrPng = file.type === 'image/jpeg' || file.type === 'image/png' || file.type === 'image/jpg'\n  if (!isJpgOrPng) {\n    return\n  }\n  const isLt2M = file.size / 1024 / 1024 < 20 // 20M\n  if (!isLt2M) {\n    return\n  }\n  return isJpgOrPng && isLt2M\n}\nexport default {\n  name: 'ImageUpload',\n  props: {\n    // 默认列表\n    fileList: {\n      required: true,\n      type: Array\n    },\n    // 用户头像 = 》user，设备照片 =》 device，兴趣点照片 =》poi ，意见反馈照片 =》 advice\n    type: {\n      required: true,\n      type: String,\n      default: ''\n    },\n    // 限制数量\n    num: {\n      type: Number,\n      default: 6\n    },\n    listType: {\n      type: String,\n      default: 'picture-card'\n    },\n    readyOnly: {\n      type: Boolean,\n      default: false\n    }\n  },\n  data() {\n    return {\n      headers: null,\n      baseUrl: process.env.VUE_APP_BASE_API + '/images/',\n      uploadImgUrl: process.env.VUE_APP_BASE_API + \"/upload-image\", // 上传的图片服务器地址\n      previewVisible: false,\n      previewImage: '',\n      list: []\n    }\n  },\n  watch: {\n    fileList() {\n      console.log('this.fileList', this.fileList)\n      this.fileList.forEach(item => {\n        item['url'] = this.baseUrl + item.name\n      })\n      this.list = this.fileList\n    }\n  },\n  methods: {\n    handlePreview(file) {\n      this.previewImage = file.url\n      // this.previewVisible = true\n      const urls = []\n      this.list.forEach(item => {\n        urls.push(item.url)\n      })\n      /* const vViewer = this.$viewerApi({\n        images: urls,\n        url: file.url\n      }) */\n      this.$nextTick(() => {\n        const idx = this.list.findIndex(d => d.url === file.url)\n        // vViewer.update().view(idx)\n      })\n    },\n    handleUploadSuccess(res, file, fileList) {\n      console.log('res, file', res, file, fileList)\n      fileList.forEach(item => {\n        if (item.response) {\n          item['url'] = this.baseUrl + item.response.fileName\n          item['name'] = item.response.fileName\n        }\n      })\n      this.list = fileList\n      if (res.code === 200) {\n      } else if (file.status === 'removed') {\n      } else {\n        // 如何失败，删除最后一个\n        if (!file.bb) {\n          fileList.splice(fileList.length - 1, 1)\n        }\n      }\n      this.$emit('listChange', fileList)\n    },\n    handleBeforeUpload(file) {\n      const bb = validateImage(file)\n      file['bb'] = bb\n      return bb\n    }\n  }\n};\n</script>\n<style scoped lang=\"scss\">\n// .el-upload--picture-card 控制加号部分\n::v-deep.hide .el-upload--picture-card {\n  display: none;\n}\n// 去掉动画效果\n::v-deep .el-list-enter-active,\n::v-deep .el-list-leave-active {\n  transition: all 0s;\n}\n\n::v-deep .el-list-enter, .el-list-leave-active {\n  opacity: 0;\n  transform: translateY(0);\n}\n</style>\n\n"]}]}