{"remainingRequest":"E:\\workspacevsCode\\web-ui-travel\\node_modules\\babel-loader\\lib\\index.js!E:\\workspacevsCode\\web-ui-travel\\node_modules\\@vue\\cli-plugin-eslint\\node_modules\\eslint-loader\\index.js??ref--13-0!E:\\workspacevsCode\\web-ui-travel\\src\\views\\AMyWork\\tools\\poi\\DouglasPeuker.js","dependencies":[{"path":"E:\\workspacevsCode\\web-ui-travel\\src\\views\\AMyWork\\tools\\poi\\DouglasPeuker.js","mtime":1722244407984},{"path":"E:\\workspacevsCode\\web-ui-travel\\babel.config.js","mtime":1677117676000},{"path":"E:\\workspacevsCode\\web-ui-travel\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\workspacevsCode\\web-ui-travel\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"E:\\workspacevsCode\\web-ui-travel\\node_modules\\@vue\\cli-plugin-eslint\\node_modules\\eslint-loader\\index.js","mtime":1720856214296}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLmRvdWdsYXNQZXVja2VyID0gZG91Z2xhc1BldWNrZXI7CnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5tYXAuanMiKTsKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnB1c2guanMiKTsKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNvcnQuanMiKTsKLy8g6K6h566X6Led56a7CmZ1bmN0aW9uIGNhbGN1bGF0aW9uRGlzdGFuY2UocG9pbnQxLCBwb2ludDIpIHsKICB2YXIgbGF0MSA9IHBvaW50MS5sYXQ7CiAgdmFyIGxhdDIgPSBwb2ludDIubGF0OwogIHZhciBsbmcxID0gcG9pbnQxLmxuZzsKICB2YXIgbG5nMiA9IHBvaW50Mi5sbmc7CiAgdmFyIHJhZExhdDEgPSBsYXQxICogTWF0aC5QSSAvIDE4MC4wOwogIHZhciByYWRMYXQyID0gbGF0MiAqIE1hdGguUEkgLyAxODAuMDsKICB2YXIgYSA9IHJhZExhdDEgLSByYWRMYXQyOwogIHZhciBiID0gbG5nMSAqIE1hdGguUEkgLyAxODAuMCAtIGxuZzIgKiBNYXRoLlBJIC8gMTgwLjA7CiAgdmFyIHMgPSAyICogTWF0aC5hc2luKE1hdGguc3FydChNYXRoLnBvdyhNYXRoLnNpbihhIC8gMiksIDIpICsgTWF0aC5jb3MocmFkTGF0MSkgKiBNYXRoLmNvcyhyYWRMYXQyKSAqIE1hdGgucG93KE1hdGguc2luKGIgLyAyKSwgMikpKTsKICByZXR1cm4gcyAqIDYzNzA5OTYuODE7Cn0KCi8vIOiuoeeul+Wegui3nQpmdW5jdGlvbiBkaXN0VG9TZWdtZW50KHN0YXJ0LCBlbmQsIGNlbnRlcikgewogIC8vIOeUqOa1t+S8puWFrOW8j+iuoeeul+mdouenrwogIHZhciBhID0gTWF0aC5hYnMoY2FsY3VsYXRpb25EaXN0YW5jZShzdGFydCwgZW5kKSk7CiAgdmFyIGIgPSBNYXRoLmFicyhjYWxjdWxhdGlvbkRpc3RhbmNlKHN0YXJ0LCBjZW50ZXIpKTsKICB2YXIgYyA9IE1hdGguYWJzKGNhbGN1bGF0aW9uRGlzdGFuY2UoZW5kLCBjZW50ZXIpKTsKICB2YXIgcCA9IChhICsgYiArIGMpIC8gMi4wOwogIHZhciBzID0gTWF0aC5zcXJ0KE1hdGguYWJzKHAgKiAocCAtIGEpICogKHAgLSBiKSAqIChwIC0gYykpKTsKICByZXR1cm4gcyAqIDIuMCAvIGE7Cn0KCi8vIOmAkuW9kuaWueW8j+WOi+e8qei9qOi/uQpmdW5jdGlvbiBjb21wcmVzc0xpbmUoY29vcmRpbmF0ZSwgcmVzdWx0LCBzdGFydCwgZW5kLCBkTWF4KSB7CiAgaWYgKHN0YXJ0IDwgZW5kKSB7CiAgICB2YXIgbWF4RGlzdCA9IDA7CiAgICB2YXIgY3VycmVudEluZGV4ID0gMDsKICAgIHZhciBzdGFydFBvaW50ID0gY29vcmRpbmF0ZVtzdGFydF07CiAgICB2YXIgZW5kUG9pbnQgPSBjb29yZGluYXRlW2VuZCAtIDFdOwogICAgZm9yICh2YXIgaSA9IHN0YXJ0ICsgMTsgaSA8IGVuZDsgaSsrKSB7CiAgICAgIHZhciBjdXJyZW50RGlzdCA9IGRpc3RUb1NlZ21lbnQoc3RhcnRQb2ludCwgZW5kUG9pbnQsIGNvb3JkaW5hdGVbaV0pOwogICAgICBpZiAoY3VycmVudERpc3QgPiBtYXhEaXN0KSB7CiAgICAgICAgbWF4RGlzdCA9IGN1cnJlbnREaXN0OwogICAgICAgIGN1cnJlbnRJbmRleCA9IGk7CiAgICAgIH0KICAgIH0KICAgIGlmIChtYXhEaXN0ID49IGRNYXgpIHsKICAgICAgLy8g5bCG5b2T5YmN54K55Yqg5YWl5Yiw6L+H5ruk5pWw57uE5LitCiAgICAgIHJlc3VsdC5wdXNoKGNvb3JkaW5hdGVbY3VycmVudEluZGV4XSk7CiAgICAgIC8vIOWwhuWOn+adpeeahOe6v+auteS7peW9k+WJjeeCueS4uuS4reW/g+aLhuaIkOS4pOaute+8jOWIhuWIq+i/m+ihjOmAkuW9kuWkhOeQhgogICAgICBjb21wcmVzc0xpbmUoY29vcmRpbmF0ZSwgcmVzdWx0LCBzdGFydCwgY3VycmVudEluZGV4LCBkTWF4KTsKICAgICAgY29tcHJlc3NMaW5lKGNvb3JkaW5hdGUsIHJlc3VsdCwgY3VycmVudEluZGV4LCBlbmQsIGRNYXgpOwogICAgfQogIH0KICByZXR1cm4gcmVzdWx0Owp9CgovKioNCiAqIEBwYXJhbSBjb29yZGluYXRlcyDljp/lp4vovajov7kgQXJyYXk8e2xhdCwgbG5nLCB0aW1lfT4NCiAqIEBwYXJhbSBkTWF4IOWFgeiuuOacgOWkp+i3neemu+ivr+W3rg0KICogQHJldHVybiDmir3nqIDlkI7nmoTovajov7kgQXJyYXk8W2xhdCwgbG5nLCB0aW1lXT4NCiAqLwpmdW5jdGlvbiBkb3VnbGFzUGV1Y2tlcihjb29yZGluYXRlcywgZE1heCkgewogIGlmICghY29vcmRpbmF0ZXMgfHwgIShjb29yZGluYXRlcy5sZW5ndGggPiAyKSkgewogICAgcmV0dXJuIG51bGw7CiAgfQoKICAvLyDlsIbovpPlhaXmlbDmja7ovazmjaLkuLrljIXlkKsgbGF0IOWSjCBsbmcg55qE5a+56LGhCiAgdmFyIGNvb3JkaW5hdGUgPSBjb29yZGluYXRlcy5tYXAoZnVuY3Rpb24gKGl0ZW0sIGluZGV4KSB7CiAgICByZXR1cm4gewogICAgICBsYXQ6IGl0ZW0ubGF0LAogICAgICBsbmc6IGl0ZW0ubG5nLAogICAgICB0aW1lOiBpdGVtLnRpbWUsCiAgICAgIGtleTogaW5kZXgKICAgIH07CiAgfSk7CiAgdmFyIHJlc3VsdCA9IGNvbXByZXNzTGluZShjb29yZGluYXRlLCBbXSwgMCwgY29vcmRpbmF0ZS5sZW5ndGggLSAxLCBkTWF4KTsKICByZXN1bHQucHVzaChjb29yZGluYXRlWzBdKTsKICByZXN1bHQucHVzaChjb29yZGluYXRlW2Nvb3JkaW5hdGUubGVuZ3RoIC0gMV0pOwogIHZhciByZXN1bHRMYXRMbmcgPSByZXN1bHQuc29ydChmdW5jdGlvbiAoYSwgYikgewogICAgaWYgKGEua2V5IDwgYi5rZXkpIHsKICAgICAgcmV0dXJuIC0xOwogICAgfSBlbHNlIGlmIChhLmtleSA+IGIua2V5KSByZXR1cm4gMTsKICAgIHJldHVybiAwOwogIH0pOwogIC8vIOi9rOaNouWbnuWOn+Wni+aVsOe7hOagvOW8jwogIHJldHVybiByZXN1bHRMYXRMbmcubWFwKGZ1bmN0aW9uIChpdGVtKSB7CiAgICByZXR1cm4gW2l0ZW0ubGF0LCBpdGVtLmxuZywgaXRlbS50aW1lXTsKICB9KTsKfQ=="},{"version":3,"names":["calculationDistance","point1","point2","lat1","lat","lat2","lng1","lng","lng2","radLat1","Math","PI","radLat2","a","b","s","asin","sqrt","pow","sin","cos","distToSegment","start","end","center","abs","c","p","compressLine","coordinate","result","dMax","maxDist","currentIndex","startPoint","endPoint","i","currentDist","push","douglasPeucker","coordinates","length","map","item","index","time","key","resultLatLng","sort"],"sources":["E:/workspacevsCode/web-ui-travel/src/views/AMyWork/tools/poi/DouglasPeuker.js"],"sourcesContent":["// 计算距离\r\nfunction calculationDistance(point1, point2) {\r\n    let lat1 = point1.lat;\r\n    let lat2 = point2.lat;\r\n    let lng1 = point1.lng;\r\n    let lng2 = point2.lng;\r\n    let radLat1 = lat1 * Math.PI / 180.0;\r\n    let radLat2 = lat2 * Math.PI / 180.0;\r\n    let a = radLat1 - radLat2;\r\n    let b = (lng1 * Math.PI / 180.0) - (lng2 * Math.PI / 180.0);\r\n    let s = 2 * Math.asin(Math.sqrt(Math.pow(Math.sin(a / 2), 2)\r\n        + Math.cos(radLat1) * Math.cos(radLat2) * Math.pow(Math.sin(b / 2), 2)));\r\n    return s * 6370996.81;\r\n}\r\n\r\n// 计算垂距\r\nfunction distToSegment(start, end, center) {\r\n    // 用海伦公式计算面积\r\n    let a = Math.abs(calculationDistance(start, end));\r\n    let b = Math.abs(calculationDistance(start, center));\r\n    let c = Math.abs(calculationDistance(end, center));\r\n    let p = (a + b + c) / 2.0;\r\n    let s = Math.sqrt(Math.abs(p * (p - a) * (p - b) * (p - c)));\r\n    return s * 2.0 / a;\r\n}\r\n\r\n// 递归方式压缩轨迹\r\nfunction compressLine(coordinate, result, start, end, dMax) {\r\n    if (start < end) {\r\n        let maxDist = 0;\r\n        let currentIndex = 0;\r\n        let startPoint = coordinate[start]\r\n        let endPoint = coordinate[end-1]\r\n        for (let i = start + 1; i < end; i++) {\r\n            let currentDist = distToSegment(startPoint, endPoint, coordinate[i]);\r\n            if (currentDist > maxDist) {\r\n                maxDist = currentDist;\r\n                currentIndex = i;\r\n            }\r\n        }\r\n\r\n        if (maxDist >= dMax) {\r\n            // 将当前点加入到过滤数组中\r\n            result.push(coordinate[currentIndex]);\r\n            // 将原来的线段以当前点为中心拆成两段，分别进行递归处理\r\n            compressLine(coordinate, result, start, currentIndex, dMax);\r\n            compressLine(coordinate, result, currentIndex, end, dMax);\r\n        }\r\n    }\r\n    return result;\r\n}\r\n\r\n/**\r\n * @param coordinates 原始轨迹 Array<{lat, lng, time}>\r\n * @param dMax 允许最大距离误差\r\n * @return 抽稀后的轨迹 Array<[lat, lng, time]>\r\n */\r\nexport function douglasPeucker(coordinates, dMax) {\r\n    if (!coordinates || !(coordinates.length > 2)) {\r\n        return null;\r\n    }\r\n\r\n    // 将输入数据转换为包含 lat 和 lng 的对象\r\n    let coordinate = coordinates.map((item, index) => ({\r\n        lat: item.lat,\r\n        lng: item.lng,\r\n        time: item.time,\r\n        key: index\r\n    }));\r\n\r\n    let result = compressLine(coordinate, [], 0, coordinate.length - 1, dMax);\r\n    result.push(coordinate[0]);\r\n    result.push(coordinate[coordinate.length - 1]);\r\n\r\n    let resultLatLng = result.sort((a, b) => {\r\n        if (a.key < b.key) {\r\n            return -1;\r\n        } else if (a.key > b.key)\r\n            return 1;\r\n        return 0;\r\n    });\r\n    // 转换回原始数组格式\r\n    return resultLatLng.map(item => [item.lat, item.lng, item.time])\r\n}"],"mappings":"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","ignoreList":[]}]}