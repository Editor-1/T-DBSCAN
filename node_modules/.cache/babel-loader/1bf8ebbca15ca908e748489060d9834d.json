{"remainingRequest":"E:\\GitProject\\T-DBSCAN\\node_modules\\babel-loader\\lib\\index.js!E:\\GitProject\\T-DBSCAN\\node_modules\\@vue\\cli-plugin-eslint\\node_modules\\eslint-loader\\index.js??ref--13-0!E:\\GitProject\\T-DBSCAN\\src\\views\\AMyWork\\tools\\algo\\DouglasPeuker.js","dependencies":[{"path":"E:\\GitProject\\T-DBSCAN\\src\\views\\AMyWork\\tools\\algo\\DouglasPeuker.js","mtime":1727268709708},{"path":"E:\\GitProject\\T-DBSCAN\\babel.config.js","mtime":1677117676000},{"path":"E:\\GitProject\\T-DBSCAN\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\GitProject\\T-DBSCAN\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"E:\\GitProject\\T-DBSCAN\\node_modules\\@vue\\cli-plugin-eslint\\node_modules\\eslint-loader\\index.js","mtime":1720856214296}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKdmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKCJFOi9HaXRQcm9qZWN0L1QtREJTQ0FOL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2ludGVyb3BSZXF1aXJlRGVmYXVsdC5qcyIpLmRlZmF1bHQ7Ck9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKZXhwb3J0cy5kb3VnbGFzUGV1Y2tlciA9IGRvdWdsYXNQZXVja2VyOwp2YXIgX29iamVjdFNwcmVhZDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIkU6L0dpdFByb2plY3QvVC1EQlNDQU4vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvb2JqZWN0U3ByZWFkMi5qcyIpKTsKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5Lm1hcC5qcyIpOwpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyIpOwpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc29ydC5qcyIpOwp2YXIgX3B1Yk1ldGhvZHMgPSByZXF1aXJlKCIuL3B1Yk1ldGhvZHMiKTsKLy8g6K6h566X5Z6C6LedCmZ1bmN0aW9uIGRpc3RUb1NlZ21lbnQoc3RhcnQsIGVuZCwgY2VudGVyKSB7CiAgLy8g55So5rW35Lym5YWs5byP6K6h566X6Z2i56evCiAgdmFyIGEgPSBNYXRoLmFicygoMCwgX3B1Yk1ldGhvZHMuY2FsY3VsYXRlRGlzdGFuY2UpKHN0YXJ0LCBlbmQpKTsKICB2YXIgYiA9IE1hdGguYWJzKCgwLCBfcHViTWV0aG9kcy5jYWxjdWxhdGVEaXN0YW5jZSkoc3RhcnQsIGNlbnRlcikpOwogIHZhciBjID0gTWF0aC5hYnMoKDAsIF9wdWJNZXRob2RzLmNhbGN1bGF0ZURpc3RhbmNlKShlbmQsIGNlbnRlcikpOwogIHZhciBwID0gKGEgKyBiICsgYykgLyAyLjA7CiAgdmFyIHMgPSBNYXRoLnNxcnQoTWF0aC5hYnMocCAqIChwIC0gYSkgKiAocCAtIGIpICogKHAgLSBjKSkpOwogIHJldHVybiBzICogMi4wIC8gYTsKfQoKLy8g6YCS5b2S5pa55byP5Y6L57yp6L2o6L+5CmZ1bmN0aW9uIGNvbXByZXNzTGluZShjb29yZGluYXRlLCByZXN1bHQsIHN0YXJ0LCBlbmQsIGRNYXgpIHsKICBpZiAoc3RhcnQgPCBlbmQpIHsKICAgIHZhciBtYXhEaXN0ID0gMDsKICAgIHZhciBjdXJyZW50SW5kZXggPSAwOwogICAgdmFyIHN0YXJ0UG9pbnQgPSBjb29yZGluYXRlW3N0YXJ0XTsKICAgIHZhciBlbmRQb2ludCA9IGNvb3JkaW5hdGVbZW5kIC0gMV07CiAgICBmb3IgKHZhciBpID0gc3RhcnQgKyAxOyBpIDwgZW5kOyBpKyspIHsKICAgICAgdmFyIGN1cnJlbnREaXN0ID0gZGlzdFRvU2VnbWVudChzdGFydFBvaW50LCBlbmRQb2ludCwgY29vcmRpbmF0ZVtpXSk7CiAgICAgIGlmIChjdXJyZW50RGlzdCA+IG1heERpc3QpIHsKICAgICAgICBtYXhEaXN0ID0gY3VycmVudERpc3Q7CiAgICAgICAgY3VycmVudEluZGV4ID0gaTsKICAgICAgfQogICAgfQogICAgaWYgKG1heERpc3QgPj0gZE1heCkgewogICAgICAvLyDlsIblvZPliY3ngrnliqDlhaXliLDov4fmu6TmlbDnu4TkuK0KICAgICAgcmVzdWx0LnB1c2goY29vcmRpbmF0ZVtjdXJyZW50SW5kZXhdKTsKICAgICAgLy8g5bCG5Y6f5p2l55qE57q/5q615Lul5b2T5YmN54K55Li65Lit5b+D5ouG5oiQ5Lik5q6177yM5YiG5Yir6L+b6KGM6YCS5b2S5aSE55CGCiAgICAgIGNvbXByZXNzTGluZShjb29yZGluYXRlLCByZXN1bHQsIHN0YXJ0LCBjdXJyZW50SW5kZXgsIGRNYXgpOwogICAgICBjb21wcmVzc0xpbmUoY29vcmRpbmF0ZSwgcmVzdWx0LCBjdXJyZW50SW5kZXgsIGVuZCwgZE1heCk7CiAgICB9CiAgfQogIHJldHVybiByZXN1bHQ7Cn0KCi8qKg0KICogQHBhcmFtIGNvb3JkaW5hdGVzIOWOn+Wni+i9qOi/uSBBcnJheTx7bGF0LCBsbmcsIHRpbWV9Pg0KICogQHBhcmFtIGRNYXgg5YWB6K645pyA5aSn6Led56a76K+v5beuDQogKiBAcmV0dXJuIOaKveeogOWQjueahOi9qOi/uSBBcnJheTxbbGF0LCBsbmcsIHRpbWVdPg0KICovCmZ1bmN0aW9uIGRvdWdsYXNQZXVja2VyKGNvb3JkaW5hdGVzLCBkTWF4KSB7CiAgaWYgKCFjb29yZGluYXRlcyB8fCAhKGNvb3JkaW5hdGVzLmxlbmd0aCA+IDIpKSB7CiAgICByZXR1cm4gbnVsbDsKICB9CiAgLy8g5bCG6L6T5YWl5pWw5o2u6L2s5o2i5Li65YyF5ZCrIGxhdCDlkowgbG5nIOeahOWvueixoQogIHZhciBjb29yZGluYXRlID0gY29vcmRpbmF0ZXMubWFwKGZ1bmN0aW9uIChpdGVtLCBpbmRleCkgewogICAgcmV0dXJuICgwLCBfb2JqZWN0U3ByZWFkMi5kZWZhdWx0KSgoMCwgX29iamVjdFNwcmVhZDIuZGVmYXVsdCkoewogICAgICBsYXQ6IGl0ZW0ubGF0LAogICAgICBsbmc6IGl0ZW0ubG5nCiAgICB9LCBpdGVtLnRpbWUgPyB7CiAgICAgIHRpbWU6IGl0ZW0udGltZQogICAgfSA6IHt9KSwge30sIHsKICAgICAgLy8g5LuF5b2TIGl0ZW0udGltZSDlrZjlnKjml7bmiY3mt7vliqAgdGltZSDlsZ7mgKcKICAgICAga2V5OiBpbmRleAogICAgfSk7CiAgfSk7CiAgdmFyIHJlc3VsdCA9IGNvbXByZXNzTGluZShjb29yZGluYXRlLCBbXSwgMCwgY29vcmRpbmF0ZS5sZW5ndGggLSAxLCBkTWF4KTsKICByZXN1bHQucHVzaChjb29yZGluYXRlWzBdKTsKICByZXN1bHQucHVzaChjb29yZGluYXRlW2Nvb3JkaW5hdGUubGVuZ3RoIC0gMV0pOwogIHZhciByZXN1bHRMYXRMbmcgPSByZXN1bHQuc29ydChmdW5jdGlvbiAoYSwgYikgewogICAgaWYgKGEua2V5IDwgYi5rZXkpIHsKICAgICAgcmV0dXJuIC0xOwogICAgfSBlbHNlIGlmIChhLmtleSA+IGIua2V5KSByZXR1cm4gMTsKICAgIHJldHVybiAwOwogIH0pOwogIHZhciB0cmFuc2Zvcm1lZCA9IHJlc3VsdExhdExuZy5tYXAoZnVuY3Rpb24gKGl0ZW0pIHsKICAgIHJldHVybiB7CiAgICAgIGxhdDogaXRlbS5sYXQsCiAgICAgIGxuZzogaXRlbS5sbmcsCiAgICAgIHRpbWU6IGl0ZW0udGltZQogICAgfTsKICB9KTsKICAvLyDovazmjaLlm57ljp/lp4vmlbDnu4TmoLzlvI8KICByZXR1cm4gdHJhbnNmb3JtZWQ7Cn0="},{"version":3,"names":["_pubMethods","require","distToSegment","start","end","center","a","Math","abs","calculateDistance","b","c","p","s","sqrt","compressLine","coordinate","result","dMax","maxDist","currentIndex","startPoint","endPoint","i","currentDist","push","douglasPeucker","coordinates","length","map","item","index","_objectSpread2","default","lat","lng","time","key","resultLatLng","sort","transformed"],"sources":["E:/GitProject/T-DBSCAN/src/views/AMyWork/tools/algo/DouglasPeuker.js"],"sourcesContent":["import {calculateDistance} from './pubMethods'\r\n\r\n// 计算垂距\r\nfunction distToSegment(start, end, center) {\r\n    // 用海伦公式计算面积\r\n    let a = Math.abs(calculateDistance(start, end));\r\n    let b = Math.abs(calculateDistance(start, center));\r\n    let c = Math.abs(calculateDistance(end, center));\r\n    let p = (a + b + c) / 2.0;\r\n    let s = Math.sqrt(Math.abs(p * (p - a) * (p - b) * (p - c)));\r\n    return s * 2.0 / a;\r\n}\r\n\r\n// 递归方式压缩轨迹\r\nfunction compressLine(coordinate, result, start, end, dMax) {\r\n    if (start < end) {\r\n        let maxDist = 0;\r\n        let currentIndex = 0;\r\n        let startPoint = coordinate[start]\r\n        let endPoint = coordinate[end-1]\r\n        for (let i = start + 1; i < end; i++) {\r\n            let currentDist = distToSegment(startPoint, endPoint, coordinate[i]);\r\n            if (currentDist > maxDist) {\r\n                maxDist = currentDist;\r\n                currentIndex = i;\r\n            }\r\n        }\r\n\r\n        if (maxDist >= dMax) {\r\n            // 将当前点加入到过滤数组中\r\n            result.push(coordinate[currentIndex]);\r\n            // 将原来的线段以当前点为中心拆成两段，分别进行递归处理\r\n            compressLine(coordinate, result, start, currentIndex, dMax);\r\n            compressLine(coordinate, result, currentIndex, end, dMax);\r\n        }\r\n    }\r\n    return result;\r\n}\r\n\r\n/**\r\n * @param coordinates 原始轨迹 Array<{lat, lng, time}>\r\n * @param dMax 允许最大距离误差\r\n * @return 抽稀后的轨迹 Array<[lat, lng, time]>\r\n */\r\nexport function douglasPeucker(coordinates, dMax) {\r\n    if (!coordinates || !(coordinates.length > 2)) {\r\n        return null;\r\n    }\r\n    // 将输入数据转换为包含 lat 和 lng 的对象\r\n    let coordinate = coordinates.map((item, index) => ({\r\n        lat: item.lat,\r\n        lng: item.lng,\r\n        ...(item.time ? { time: item.time } : {}), // 仅当 item.time 存在时才添加 time 属性\r\n        key: index\r\n    }));\r\n    \r\n\r\n    let result = compressLine(coordinate, [], 0, coordinate.length - 1, dMax);\r\n    result.push(coordinate[0]);\r\n    result.push(coordinate[coordinate.length - 1]);\r\n\r\n    let resultLatLng = result.sort((a, b) => {\r\n        if (a.key < b.key) {\r\n            return -1;\r\n        } else if (a.key > b.key)\r\n            return 1;\r\n        return 0;\r\n    });\r\n    const transformed = resultLatLng.map(item => ({  \r\n        lat: item.lat,  \r\n        lng: item.lng,  \r\n        time: item.time  \r\n      }));\r\n    // 转换回原始数组格式\r\n    return transformed\r\n}"],"mappings":"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","ignoreList":[]}]}